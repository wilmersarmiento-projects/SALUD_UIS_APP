<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salud UIS App | Gestión de Salud</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .animate-fadeIn { animation: fadeIn 0.4s ease-out forwards; }
        .animate-slideIn { animation: slideIn 0.5s ease-out forwards; }
        .animate-pulse-slow { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        body { font-family: 'Inter', sans-serif; scroll-behavior: smooth; }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
    </style>
</head>
<body class="bg-[#f8fafc] text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Base de datos IndexedDB (SQL-like para navegadores)
        const DB_NAME = 'SaludUISDB';
        const DB_VERSION = 1;
        const USERS_STORE = 'users';

        class DatabaseManager {
            constructor() {
                this.db = null;
            }

            async init() {
                return new Promise((resolve, reject) => {
                    const request = indexedDB.open(DB_NAME, DB_VERSION);
                    
                    request.onerror = () => reject(request.error);
                    request.onsuccess = () => {
                        this.db = request.result;
                        resolve(this.db);
                    };
                    
                    request.onupgradeneeded = (event) => {
                        const db = event.target.result;
                        if (!db.objectStoreNames.contains(USERS_STORE)) {
                            const objectStore = db.createObjectStore(USERS_STORE, { keyPath: 'email' });
                            objectStore.createIndex('email', 'email', { unique: true });
                            objectStore.createIndex('nombre', 'nombre', { unique: false });
                        }
                    };
                });
            }

            async createUser(userData) {
                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction([USERS_STORE], 'readwrite');
                    const objectStore = transaction.objectStore(USERS_STORE);
                    const request = objectStore.add({
                        ...userData,
                        fechaRegistro: new Date().toISOString()
                    });
                    
                    request.onsuccess = () => resolve(request.result);
                    request.onerror = () => reject(request.error);
                });
            }

            async getUser(email) {
                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction([USERS_STORE], 'readonly');
                    const objectStore = transaction.objectStore(USERS_STORE);
                    const request = objectStore.get(email);
                    
                    request.onsuccess = () => resolve(request.result);
                    request.onerror = () => reject(request.error);
                });
            }

            async getAllUsers() {
                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction([USERS_STORE], 'readonly');
                    const objectStore = transaction.objectStore(USERS_STORE);
                    const request = objectStore.getAll();
                    
                    request.onsuccess = () => resolve(request.result);
                    request.onerror = () => reject(request.error);
                });
            }

            async initializeDefaultUsers() {
                const defaultUsers = [
                    {
                        nombre: 'Juan',
                        apellido: 'Pérez',
                        email: 'juan.perez@uis.edu.co',
                        password: '123456',
                        telefono: '3001234567',
                        fechaNacimiento: '1990-05-15',
                        tipoDocumento: 'CC',
                        numeroDocumento: '1098765432'
                    },
                    {
                        nombre: 'María',
                        apellido: 'García',
                        email: 'maria.garcia@uis.edu.co',
                        password: '123456',
                        telefono: '3109876543',
                        fechaNacimiento: '1985-08-22',
                        tipoDocumento: 'CC',
                        numeroDocumento: '1087654321'
                    },
                    {
                        nombre: 'Carlos',
                        apellido: 'Rodríguez',
                        email: 'carlos.rodriguez@uis.edu.co',
                        password: '123456',
                        telefono: '3201122334',
                        fechaNacimiento: '1992-03-10',
                        tipoDocumento: 'CC',
                        numeroDocumento: '1076543210'
                    }
                ];

                for (const user of defaultUsers) {
                    try {
                        const existingUser = await this.getUser(user.email);
                        if (!existingUser) {
                            await this.createUser(user);
                        }
                    } catch (error) {
                        // Usuario no existe, intentar crearlo
                        try {
                            await this.createUser(user);
                        } catch (createError) {
                            console.log('Usuario ya existe:', user.email);
                        }
                    }
                }
            }

            async validateLogin(email, password) {
                const user = await this.getUser(email);
                if (user && user.password === password) {
                    return { success: true, user };
                }
                return { success: false, user: null };
            }
        }

        const dbManager = new DatabaseManager();

        const Badge = ({ children, color }) => {
            const colors = {
                green: "bg-emerald-100 text-emerald-700",
                amber: "bg-amber-100 text-amber-700",
                indigo: "bg-indigo-100 text-indigo-700",
                red: "bg-red-100 text-red-700",
                blue: "bg-blue-100 text-blue-700"
            };
            return <span className={`px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-wider ${colors[color]}`}>{children}</span>;
        };

        const RegisterScreen = ({ onBackToLogin, onRegisterSuccess }) => {
            const [formData, setFormData] = useState({
                nombre: '',
                apellido: '',
                email: '',
                password: '',
                confirmPassword: '',
                telefono: '',
                fechaNacimiento: '',
                tipoDocumento: 'CC',
                numeroDocumento: ''
            });
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);

            const handleChange = (e) => {
                setFormData({ ...formData, [e.target.name]: e.target.value });
                setError('');
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setError('');
                setLoading(true);

                // Validaciones
                if (formData.password !== formData.confirmPassword) {
                    setError('Las contraseñas no coinciden');
                    setLoading(false);
                    return;
                }

                if (formData.password.length < 6) {
                    setError('La contraseña debe tener al menos 6 caracteres');
                    setLoading(false);
                    return;
                }

                try {
                    await dbManager.init();
                    await dbManager.createUser({
                        nombre: formData.nombre,
                        apellido: formData.apellido,
                        email: formData.email,
                        password: formData.password,
                        telefono: formData.telefono,
                        fechaNacimiento: formData.fechaNacimiento,
                        tipoDocumento: formData.tipoDocumento,
                        numeroDocumento: formData.numeroDocumento
                    });
                    
                    alert('¡Registro exitoso! Ya puedes iniciar sesión');
                    onRegisterSuccess();
                } catch (err) {
                    if (err.name === 'ConstraintError') {
                        setError('Este correo ya está registrado');
                    } else {
                        setError('Error al registrar. Intenta nuevamente.');
                    }
                    console.error('Error de registro:', err);
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="min-h-screen flex items-center justify-center p-6 bg-gradient-to-br from-blue-600 via-blue-700 to-slate-900">
                    <div className="max-w-2xl w-full bg-white rounded-[3rem] p-10 shadow-2xl animate-fadeIn">
                        <div className="text-center mb-8">
                            <div className="flex items-center justify-center gap-4 mb-6">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Logotipo_UIS.png" alt="UIS Logo" className="h-16" />
                            </div>
                            <h1 className="text-4xl font-black text-slate-800 tracking-tighter">Crear Cuenta</h1>
                            <p className="text-slate-400 text-sm mt-2">Completa tus datos para registrarte</p>
                        </div>

                        {error && (
                            <div className="mb-6 p-4 bg-red-50 border-2 border-red-200 rounded-2xl text-red-700 text-sm font-bold text-center">
                                <i className="fas fa-exclamation-circle mr-2"></i>
                                {error}
                            </div>
                        )}

                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <input
                                    type="text"
                                    name="nombre"
                                    required
                                    value={formData.nombre}
                                    onChange={handleChange}
                                    placeholder="Nombre"
                                    className="w-full bg-slate-50 border border-slate-100 p-4 rounded-2xl focus:ring-2 focus:ring-blue-500 outline-none transition"
                                />
                                <input
                                    type="text"
                                    name="apellido"
                                    required
                                    value={formData.apellido}
                                    onChange={handleChange}
                                    placeholder="Apellido"
                                    className="w-full bg-slate-50 border border-slate-100 p-4 rounded-2xl focus:ring-2 focus:ring-blue-500 outline-none transition"
                                />
                            </div>

                            <input
                                type="email"
                                name="email"
                                required
                                value={formData.email}
                                onChange={handleChange}
                                placeholder="Correo electrónico"
                                className="w-full bg-slate-50 border border-slate-100 p-4 rounded-2xl focus:ring-2 focus:ring-blue-500 outline-none transition"
                            />

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <input
                                    type="password"
                                    name="password"
                                    required
                                    value={formData.password}
                                    onChange={handleChange}
                                    placeholder="Contraseña (mín. 6 caracteres)"
                                    className="w-full bg-slate-50 border border-slate-100 p-4 rounded-2xl focus:ring-2 focus:ring-blue-500 outline-none transition"
                                />
                                <input
                                    type="password"
                                    name="confirmPassword"
                                    required
                                    value={formData.confirmPassword}
                                    onChange={handleChange}
                                    placeholder="Confirmar contraseña"
                                    className="w-full bg-slate-50 border border-slate-100 p-4 rounded-2xl focus:ring-2 focus:ring-blue-500 outline-none transition"
                                />
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <select
                                    name="tipoDocumento"
                                    value={formData.tipoDocumento}
                                    onChange={handleChange}
                                    className="w-full bg-slate-50 border border-slate-100 p-4 rounded-2xl focus:ring-2 focus:ring-blue-500 outline-none transition"
                                >
                                    <option value="CC">Cédula de Ciudadanía</option>
                                    <option value="TI">Tarjeta de Identidad</option>
                                    <option value="CE">Cédula de Extranjería</option>
                                    <option value="PAS">Pasaporte</option>
                                </select>
                                <input
                                    type="text"
                                    name="numeroDocumento"
                                    required
                                    value={formData.numeroDocumento}
                                    onChange={handleChange}
                                    placeholder="Número de documento"
                                    className="w-full bg-slate-50 border border-slate-100 p-4 rounded-2xl focus:ring-2 focus:ring-blue-500 outline-none transition"
                                />
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <input
                                    type="tel"
                                    name="telefono"
                                    required
                                    value={formData.telefono}
                                    onChange={handleChange}
                                    placeholder="Teléfono"
                                    className="w-full bg-slate-50 border border-slate-100 p-4 rounded-2xl focus:ring-2 focus:ring-blue-500 outline-none transition"
                                />
                                <input
                                    type="date"
                                    name="fechaNacimiento"
                                    required
                                    value={formData.fechaNacimiento}
                                    onChange={handleChange}
                                    placeholder="Fecha de nacimiento"
                                    className="w-full bg-slate-50 border border-slate-100 p-4 rounded-2xl focus:ring-2 focus:ring-blue-500 outline-none transition"
                                />
                            </div>

                            <button
                                type="submit"
                                disabled={loading}
                                className="w-full bg-blue-600 text-white py-4 rounded-2xl font-black uppercase tracking-widest text-sm shadow-xl shadow-blue-200 hover:bg-blue-700 transition-all active:scale-95 duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                            >
                                {loading ? 'Registrando...' : 'Crear Cuenta'}
                            </button>

                            <button
                                type="button"
                                onClick={onBackToLogin}
                                className="w-full bg-slate-100 text-slate-600 py-4 rounded-2xl font-black uppercase tracking-widest text-sm hover:bg-slate-200 transition-all active:scale-95 duration-200"
                            >
                                Volver al Login
                            </button>
                        </form>
                    </div>
                </div>
            );
        };

        const LoginScreen = ({ onLogin, onShowRegister }) => {
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);

            const handleSubmit = async (e) => {
                e.preventDefault();
                setError('');
                setLoading(true);

                try {
                    await dbManager.init();
                    const result = await dbManager.validateLogin(email, password);
                    
                    if (result.success) {
                        onLogin(result.user);
                    } else {
                        setError('Correo o contraseña incorrectos');
                    }
                } catch (err) {
                    setError('Error al iniciar sesión. Intenta nuevamente.');
                    console.error('Error de login:', err);
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="min-h-screen flex items-center justify-center p-6 bg-gradient-to-br from-blue-600 via-blue-700 to-slate-900">
                    <div className="max-w-md w-full bg-white rounded-[3rem] p-10 shadow-2xl animate-fadeIn text-center">
                        <div className="flex items-center justify-center gap-4 mb-6">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Logotipo_UIS.png" alt="UIS Logo" className="h-16" />
                        </div>
                        <h1 className="text-4xl font-black text-slate-800 tracking-tighter">Salud UIS App</h1>
                        <p className="text-slate-400 text-sm mt-2 mb-8">Ingresa tus credenciales</p>
                        
                        {error && (
                            <div className="mb-6 p-4 bg-red-50 border-2 border-red-200 rounded-2xl text-red-700 text-sm font-bold">
                                <i className="fas fa-exclamation-circle mr-2"></i>
                                {error}
                            </div>
                        )}

                        <form onSubmit={handleSubmit} className="space-y-4 text-left">
                            <input
                                type="email"
                                required
                                value={email}
                                onChange={(e) => setEmail(e.target.value)}
                                placeholder="Correo electrónico"
                                className="w-full bg-slate-50 border border-slate-100 p-4 rounded-2xl focus:ring-2 focus:ring-blue-500 outline-none transition"
                            />
                            <input
                                type="password"
                                required
                                value={password}
                                onChange={(e) => setPassword(e.target.value)}
                                placeholder="Contraseña"
                                className="w-full bg-slate-50 border border-slate-100 p-4 rounded-2xl focus:ring-2 focus:ring-blue-500 outline-none transition"
                            />
                            <button
                                type="submit"
                                disabled={loading}
                                className="w-full bg-blue-600 text-white py-4 rounded-2xl font-black uppercase tracking-widest text-sm shadow-xl shadow-blue-200 hover:bg-blue-700 transition-all active:scale-95 duration-200 disabled:opacity-50"
                            >
                                {loading ? 'Ingresando...' : 'Iniciar Sesión'}
                            </button>
                            <div className="text-center pt-4">
                                <button
                                    type="button"
                                    onClick={onShowRegister}
                                    className="text-blue-600 font-bold text-sm hover:text-blue-800 transition"
                                >
                                    ¿No tienes cuenta? Regístrate aquí
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        };

        const Navbar = ({ setPage, page, onLogout, notificationCount, userName }) => (
            <nav className="bg-white/80 backdrop-blur-md border-b border-slate-100 sticky top-0 z-50">
                <div className="container mx-auto px-6 py-3 flex justify-between items-center">
                    <div className="flex items-center gap-3 cursor-pointer" onClick={() => setPage('home')}>
                        <img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Logotipo_UIS.png" alt="UIS Logo" className="h-10" />
                        <div className="hidden md:block border-l-2 border-slate-200 pl-3">
                            <p className="text-slate-800 text-sm font-black">Salud UIS</p>
                            <p className="text-slate-400 text-[10px] font-bold">Hola, {userName}</p>
                        </div>
                    </div>
                    <div className="hidden md:flex gap-3 items-center">
                        {[
                            { id: 'home', label: 'Inicio', icon: 'fa-home' },
                            { id: 'centros', label: 'Centros', icon: 'fa-hospital' },
                            { id: 'reservar', label: 'Reservar', icon: 'fa-calendar-plus' },
                            { id: 'notificaciones', label: 'Notificaciones', icon: 'fa-bell' }
                        ].map(item => (
                            <button key={item.id} onClick={() => setPage(item.id)} className={`px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition flex items-center gap-2 relative ${page === item.id ? 'bg-blue-50 text-blue-600' : 'text-slate-400 hover:text-slate-600'}`}>
                                <i className={`fas ${item.icon}`}></i>{item.label}
                                {item.id === 'notificaciones' && notificationCount > 0 && (
                                    <span className="absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-[8px] rounded-full flex items-center justify-center font-black animate-pulse-slow">{notificationCount}</span>
                                )}
                            </button>
                        ))}
                        <button onClick={onLogout} className="ml-4 w-10 h-10 bg-slate-50 text-slate-400 rounded-full flex items-center justify-center hover:bg-red-50 hover:text-red-500 transition"><i className="fas fa-power-off"></i></button>
                    </div>
                </div>
            </nav>
        );

        const Reservar = () => {
            const [step, setStep] = useState(1);
            const [formData, setFormData] = useState({
                especialidad: '',
                fecha: '',
                hora: '',
                medico: null
            });
            const [horariosDisponibles, setHorariosDisponibles] = useState([]);
            const [medicosDisponibles, setMedicosDisponibles] = useState([]);
            const [loading, setLoading] = useState(false);

            const especialidades = [
                { id: 1, nombre: 'Medicina General', icon: 'fa-stethoscope', color: 'blue' },
                { id: 2, nombre: 'Cardiología', icon: 'fa-heartbeat', color: 'red' },
                { id: 3, nombre: 'Pediatría', icon: 'fa-baby', color: 'green' },
                { id: 4, nombre: 'Odontología', icon: 'fa-tooth', color: 'indigo' }
            ];

            const medicos = {
                1: [
                    { id: 1, nombre: 'Dr. Roberto Silva', disponibilidad: 'Mañana y Tarde', rating: 4.9 },
                    { id: 2, nombre: 'Dra. Ana López', disponibilidad: 'Mañana', rating: 4.8 }
                ],
                2: [
                    { id: 3, nombre: 'Dr. Carlos Méndez', disponibilidad: 'Tarde', rating: 5.0 },
                    { id: 4, nombre: 'Dra. María García', disponibilidad: 'Mañana', rating: 4.7 }
                ],
                3: [
                    { id: 5, nombre: 'Dr. Luis Torres', disponibilidad: 'Mañana y Tarde', rating: 4.9 },
                    { id: 6, nombre: 'Dra. Carmen Ruiz', disponibilidad: 'Tarde', rating: 4.6 }
                ],
                4: [
                    { id: 7, nombre: 'Dr. Miguel Santos', disponibilidad: 'Mañana', rating: 4.8 },
                    { id: 8, nombre: 'Dra. Patricia Morales', disponibilidad: 'Mañana y Tarde', rating: 4.9 }
                ]
            };

            const handleEspecialidadSelect = (esp) => {
                setFormData({ ...formData, especialidad: esp.id });
                setMedicosDisponibles(medicos[esp.id]);
                setStep(2);
            };

            const handleMedicoSelect = (medico) => {
                setFormData({ ...formData, medico });
                setStep(3);
            };

            const handleFechaSelect = (fecha) => {
                setFormData({ ...formData, fecha });
                setLoading(true);
                setTimeout(() => {
                    setHorariosDisponibles(['08:00', '09:00', '10:00', '14:00', '15:00', '16:00']);
                    setLoading(false);
                    setStep(4);
                }, 800);
            };

            const handleHoraSelect = (hora) => {
                setFormData({ ...formData, hora });
                alert(`¡Cita agendada exitosamente!\nEspecialidad: ${especialidades.find(e => e.id === formData.especialidad)?.nombre}\nMédico: ${formData.medico.nombre}\nFecha: ${formData.fecha}\nHora: ${hora}`);
                setStep(1);
                setFormData({ especialidad: '', fecha: '', hora: '', medico: null });
            };

            return (
                <div className="p-8 animate-fadeIn max-w-5xl mx-auto">
                    <div className="mb-10 text-center">
                        <h2 className="text-4xl font-black text-slate-800 tracking-tighter">Reservar Cita</h2>
                        <p className="text-slate-500">Paso {step} de 4</p>
                    </div>

                    {step === 1 && (
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                            {especialidades.map(esp => (
                                <div
                                    key={esp.id}
                                    onClick={() => handleEspecialidadSelect(esp)}
                                    className="bg-white p-8 rounded-[2.5rem] border-2 border-slate-100 hover:border-blue-300 hover:shadow-xl transition-all cursor-pointer group"
                                >
                                    <div className={`w-16 h-16 bg-${esp.color}-100 rounded-2xl flex items-center justify-center mb-4 group-hover:scale-110 transition`}>
                                        <i className={`fas ${esp.icon} text-3xl text-${esp.color}-600`}></i>
                                    </div>
                                    <h3 className="font-black text-xl text-slate-800">{esp.nombre}</h3>
                                    <p className="text-slate-400 text-sm mt-2">Click para seleccionar</p>
                                </div>
                            ))}
                        </div>
                    )}

                    {step === 2 && (
                        <div className="space-y-4">
                            <button onClick={() => setStep(1)} className="text-blue-600 font-bold mb-4">
                                <i className="fas fa-arrow-left mr-2"></i>Volver
                            </button>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                {medicosDisponibles.map(medico => (
                                    <div
                                        key={medico.id}
                                        onClick={() => handleMedicoSelect(medico)}
                                        className="bg-white p-6 rounded-2xl border-2 border-slate-100 hover:border-blue-300 hover:shadow-xl transition-all cursor-pointer"
                                    >
                                        <div className="flex items-center gap-4">
                                            <div className="w-14 h-14 bg-blue-100 rounded-full flex items-center justify-center">
                                                <i className="fas fa-user-md text-2xl text-blue-600"></i>
                                            </div>
                                            <div className="flex-1">
                                                <h3 className="font-black text-slate-800">{medico.nombre}</h3>
                                                <p className="text-xs text-slate-400">{medico.disponibilidad}</p>
                                                <div className="flex items-center gap-1 mt-1">
                                                    <i className="fas fa-star text-amber-400 text-xs"></i>
                                                    <span className="text-xs font-bold text-slate-600">{medico.rating}</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    {step === 3 && (
                        <div className="space-y-4">
                            <button onClick={() => setStep(2)} className="text-blue-600 font-bold mb-4">
                                <i className="fas fa-arrow-left mr-2"></i>Volver
                            </button>
                            <div className="bg-white p-8 rounded-2xl">
                                <h3 className="font-black text-xl text-slate-800 mb-6">Selecciona una fecha</h3>
                                <input
                                    type="date"
                                    onChange={(e) => handleFechaSelect(e.target.value)}
                                    min={new Date().toISOString().split('T')[0]}
                                    className="w-full bg-slate-50 border border-slate-100 p-4 rounded-2xl focus:ring-2 focus:ring-blue-500 outline-none transition"
                                />
                            </div>
                        </div>
                    )}

                    {step === 4 && (
                        <div className="space-y-4">
                            <button onClick={() => setStep(3)} className="text-blue-600 font-bold mb-4">
                                <i className="fas fa-arrow-left mr-2"></i>Volver
                            </button>
                            {loading ? (
                                <div className="text-center py-20">
                                    <i className="fas fa-spinner fa-spin text-4xl text-blue-600"></i>
                                    <p className="text-slate-400 mt-4">Cargando horarios disponibles...</p>
                                </div>
                            ) : (
                                <div className="bg-white p-8 rounded-2xl">
                                    <h3 className="font-black text-xl text-slate-800 mb-6">Horarios disponibles</h3>
                                    <div className="grid grid-cols-3 md:grid-cols-6 gap-4">
                                        {horariosDisponibles.map(hora => (
                                            <button
                                                key={hora}
                                                onClick={() => handleHoraSelect(hora)}
                                                className="bg-blue-50 hover:bg-blue-600 hover:text-white text-blue-600 py-4 px-6 rounded-xl font-black transition-all active:scale-95"
                                            >
                                                {hora}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        };

        const Notificaciones = ({ onMarkAsRead, notificaciones }) => {
            const [filter, setFilter] = useState('todas');

            const filtradas = filter === 'todas' ? notificaciones : notificaciones.filter(n => !n.leido);

            return (
                <div className="p-8 animate-fadeIn max-w-5xl mx-auto">
                    <div className="mb-10">
                        <h2 className="text-4xl font-black text-slate-800 tracking-tighter mb-6">Notificaciones</h2>
                        <div className="flex gap-4 items-center justify-between flex-wrap">
                            <div className="flex gap-2">
                                <button
                                    onClick={() => setFilter('todas')}
                                    className={`px-6 py-3 rounded-xl font-black text-[10px] uppercase tracking-widest transition ${
                                        filter === 'todas' ? 'bg-blue-600 text-white' : 'bg-white text-slate-400'
                                    }`}
                                >
                                    Todas
                                </button>
                                <button
                                    onClick={() => setFilter('noLeidas')}
                                    className={`px-6 py-3 rounded-xl font-black text-[10px] uppercase tracking-widest transition ${
                                        filter === 'noLeidas' ? 'bg-blue-600 text-white' : 'bg-white text-slate-400'
                                    }`}
                                >
                                    No Leídas
                                </button>
                            </div>
                            <button
                                onClick={onMarkAsRead}
                                className="px-6 py-3 bg-slate-900 text-white rounded-xl font-black text-[10px] uppercase tracking-widest hover:bg-blue-600 transition"
                            >
                                <i className="fas fa-check-double mr-2"></i>
                                Marcar todas como leídas
                            </button>
                        </div>
                    </div>

                    <div className="space-y-4">
                        {filtradas.length === 0 ? (
                            <div className="text-center py-20">
                                <i className="fas fa-inbox text-6xl text-slate-200 mb-4"></i>
                                <p className="text-slate-400 font-bold">No hay notificaciones {filter === 'noLeidas' ? 'sin leer' : ''}</p>
                            </div>
                        ) : (
                            filtradas.map((notif, index) => (
                                <div
                                    key={notif.id}
                                    className={`p-6 rounded-2xl border-2 transition-all hover:shadow-md cursor-pointer animate-slideIn ${
                                        notif.leido 
                                            ? 'bg-white border-slate-100' 
                                            : 'bg-gradient-to-r from-blue-50 to-sky-50 border-blue-200'
                                    }`}
                                    style={{ animationDelay: `${index * 0.05}s` }}
                                >
                                    <div className="flex gap-4 items-start">
                                        <div className={`w-12 h-12 flex-shrink-0 rounded-xl flex items-center justify-center text-xl bg-${notif.color}-100 text-${notif.color}-600`}>
                                            <i className={`fas ${notif.icon}`}></i>
                                        </div>
                                        <div className="flex-1 min-w-0">
                                            <div className="flex items-start justify-between gap-4 mb-1">
                                                <h3 className="font-black text-slate-800 text-sm">{notif.titulo}</h3>
                                                {!notif.leido && (
                                                    <span className="w-3 h-3 bg-blue-600 rounded-full flex-shrink-0 animate-pulse-slow"></span>
                                                )}
                                            </div>
                                            <p className="text-slate-600 text-sm mb-2">{notif.mensaje}</p>
                                            <div className="flex items-center gap-4">
                                                <span className="text-[10px] text-slate-400 font-bold uppercase tracking-wider">
                                                    <i className="far fa-clock mr-1"></i>
                                                    {notif.tiempo}
                                                </span>
                                                <Badge color={notif.color}>{notif.tipo}</Badge>
                                            </div>
                                        </div>
                                        <button className="text-slate-300 hover:text-blue-600 transition">
                                            <i className="fas fa-chevron-right"></i>
                                        </button>
                                    </div>
                                </div>
                            ))
                        )}
                    </div>
                </div>
            );
        };

        const Centros = () => {
            const centros = [
                { id: 1, name: "Centro Médico UIS Norte", esp: "Especialidades Médicas", hours: "08:00 - 22:00", address: "Av. Las Camelias 450", img: "https://images.unsplash.com/photo-1519494026892-80bbd2d6fd0d?auto=format&fit=crop&q=80&w=600" },
                { id: 2, name: "Centro San Cristóbal", esp: "Pediatría y General", hours: "24 Horas", address: "Calle San Juan 128", img: "https://images.unsplash.com/photo-1586773860418-d37222d8fce3?auto=format&fit=crop&q=80&w=600" },
                { id: 3, name: "Centro Diagnóstico UIS", esp: "Alta Tecnología Médica", hours: "07:00 - 20:00", address: "Carrera 15 #88-20", img: "https://images.unsplash.com/photo-1516549655169-df83a0774514?auto=format&fit=crop&q=80&w=600" }
            ];
            return (
                <div className="p-8 animate-fadeIn max-w-7xl mx-auto">
                    <div className="mb-10 text-center"><h2 className="text-4xl font-black text-slate-800 tracking-tighter">Nuestra Red Médica</h2><p className="text-slate-500">Centros de atención de alta complejidad.</p></div>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                        {centros.map(c => (
                            <div key={c.id} className="bg-white rounded-[3rem] shadow-xl overflow-hidden group hover:-translate-y-2 transition-all duration-500">
                                <div className="h-48 overflow-hidden relative"><img src={c.img} className="w-full h-full object-cover group-hover:scale-110 transition duration-700" /><div className="absolute top-4 right-4"><Badge color="blue">{c.hours}</Badge></div></div>
                                <div className="p-8">
                                    <h3 className="font-black text-xl text-slate-800">{c.name}</h3>
                                    <p className="text-blue-600 text-[9px] font-black uppercase mb-4 tracking-widest">{c.esp}</p>
                                    <div className="text-xs text-slate-500 mb-6 flex gap-2"><i className="fas fa-map-marker-alt text-blue-400"></i> {c.address}</div>
                                    <button className="w-full bg-slate-900 text-white py-3 rounded-xl text-[10px] font-black uppercase hover:bg-blue-600 transition">Ver Ubicación</button>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const Dashboard = ({ userName, userEmail, userStats }) => (
            <div className="p-8 animate-fadeIn space-y-8 max-w-7xl mx-auto">
                {/* Header con logo UIS */}
                <div className="flex items-center justify-between mb-6">
                    <div>
                        <h1 className="text-5xl font-black text-slate-800 tracking-tighter mb-2">Panel de Salud</h1>
                        <p className="text-slate-500">Gestiona tu bienestar desde un solo lugar</p>
                    </div>
                    <img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Logotipo_UIS.png" alt="UIS Logo" className="h-16 opacity-80" />
                </div>

                {/* Banner de bienvenida mejorado */}
                <div className="bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-800 rounded-[3rem] p-10 text-white relative overflow-hidden shadow-2xl">
                    <div className="absolute top-0 right-0 w-96 h-96 bg-white opacity-5 rounded-full -mr-48 -mt-48"></div>
                    <div className="absolute bottom-0 left-0 w-64 h-64 bg-white opacity-5 rounded-full -ml-32 -mb-32"></div>
                    <div className="relative z-10 flex items-center justify-between">
                        <div className="flex-1">
                            <h2 className="text-4xl font-black tracking-tighter mb-3">¡Hola, {userName}!</h2>
                            <p className="text-blue-100 max-w-md text-lg mb-4">{userStats.mensaje}</p>
                            <div className="flex gap-3">
                                <button className="bg-white text-blue-600 px-6 py-3 rounded-xl font-black text-sm hover:bg-blue-50 transition shadow-lg">
                                    <i className="fas fa-calendar-plus mr-2"></i>Agendar Cita
                                </button>
                                <button className="bg-blue-500 text-white px-6 py-3 rounded-xl font-black text-sm hover:bg-blue-400 transition">
                                    <i className="fas fa-file-medical mr-2"></i>Ver Resultados
                                </button>
                            </div>
                        </div>
                        <div className="hidden lg:block">
                            <i className="fas fa-user-md text-[12rem] opacity-10"></i>
                        </div>
                    </div>
                </div>

                {/* Estadísticas mejoradas */}
                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                    {[
                        {l:'Citas Programadas', v: userStats.citas, i:'fa-calendar-check', color: 'blue', bg: 'from-blue-500 to-blue-600'},
                        {l:'Resultados Médicos', v: userStats.resultados, i:'fa-vial', color: 'green', bg: 'from-green-500 to-emerald-600'},
                        {l:'Notificaciones', v: userStats.notificaciones.length.toString().padStart(2, '0'), i:'fa-bell', color: 'amber', bg: 'from-amber-500 to-orange-600'}
                    ].map((s, i) => (
                        <div key={i} className={`bg-gradient-to-br ${s.bg} p-8 rounded-[2.5rem] text-white shadow-xl hover:scale-105 transition-all duration-300 cursor-pointer group relative overflow-hidden`}>
                            <div className="absolute top-0 right-0 w-32 h-32 bg-white opacity-10 rounded-full -mr-16 -mt-16"></div>
                            <div className="relative z-10">
                                <div className="flex items-center justify-between mb-4">
                                    <div className={`w-14 h-14 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center text-2xl backdrop-blur-sm`}>
                                        <i className={`fas ${s.i}`}></i>
                                    </div>
                                    <i className={`fas fa-arrow-right text-2xl opacity-0 group-hover:opacity-100 transition`}></i>
                                </div>
                                <h3 className="text-5xl font-black mb-2">{s.v}</h3>
                                <p className="text-sm font-bold opacity-90">{s.l}</p>
                            </div>
                        </div>
                    ))}
                </div>

                {/* Sección de acceso rápido */}
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    {/* Próximas citas */}
                    <div className="bg-white rounded-[2.5rem] p-8 shadow-lg border-2 border-slate-100">
                        <div className="flex items-center justify-between mb-6">
                            <h3 className="text-2xl font-black text-slate-800">Próximas Citas</h3>
                            <button className="text-blue-600 text-sm font-bold hover:text-blue-800">Ver todas <i className="fas fa-arrow-right ml-1"></i></button>
                        </div>
                        <div className="space-y-4">
                            {userStats.citas === '00' ? (
                                <div className="text-center py-8">
                                    <i className="fas fa-calendar-times text-6xl text-slate-200 mb-3"></i>
                                    <p className="text-slate-400 font-bold">No tienes citas programadas</p>
                                    <button className="mt-4 bg-blue-600 text-white px-6 py-3 rounded-xl font-black text-xs hover:bg-blue-700 transition">
                                        <i className="fas fa-plus mr-2"></i>Agendar Primera Cita
                                    </button>
                                </div>
                            ) : (
                                <>
                                    <div className="flex items-center gap-4 p-4 bg-blue-50 rounded-2xl hover:bg-blue-100 transition cursor-pointer">
                                        <div className="w-16 h-16 bg-blue-600 rounded-xl flex items-center justify-center text-white flex-shrink-0">
                                            <div className="text-center">
                                                <div className="text-2xl font-black">15</div>
                                                <div className="text-[8px] uppercase">Feb</div>
                                            </div>
                                        </div>
                                        <div className="flex-1">
                                            <h4 className="font-black text-slate-800">Dr. Roberto Silva</h4>
                                            <p className="text-sm text-slate-500">Medicina General</p>
                                            <p className="text-xs text-blue-600 font-bold mt-1"><i className="far fa-clock mr-1"></i>10:00 AM</p>
                                        </div>
                                        <i className="fas fa-chevron-right text-slate-300"></i>
                                    </div>
                                    <div className="flex items-center gap-4 p-4 bg-slate-50 rounded-2xl hover:bg-slate-100 transition cursor-pointer">
                                        <div className="w-16 h-16 bg-slate-600 rounded-xl flex items-center justify-center text-white flex-shrink-0">
                                            <div className="text-center">
                                                <div className="text-2xl font-black">20</div>
                                                <div className="text-[8px] uppercase">Feb</div>
                                            </div>
                                        </div>
                                        <div className="flex-1">
                                            <h4 className="font-black text-slate-800">Dra. María García</h4>
                                            <p className="text-sm text-slate-500">Cardiología</p>
                                            <p className="text-xs text-slate-600 font-bold mt-1"><i className="far fa-clock mr-1"></i>2:30 PM</p>
                                        </div>
                                        <i className="fas fa-chevron-right text-slate-300"></i>
                                    </div>
                                </>
                            )}
                        </div>
                    </div>

                    {/* Actividad reciente */}
                    <div className="bg-white rounded-[2.5rem] p-8 shadow-lg border-2 border-slate-100">
                        <div className="flex items-center justify-between mb-6">
                            <h3 className="text-2xl font-black text-slate-800">Actividad Reciente</h3>
                            <button className="text-blue-600 text-sm font-bold hover:text-blue-800">Ver historial <i className="fas fa-arrow-right ml-1"></i></button>
                        </div>
                        <div className="space-y-4">
                            <div className="flex items-start gap-4 pb-4 border-b border-slate-100">
                                <div className="w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center text-green-600 flex-shrink-0">
                                    <i className="fas fa-check"></i>
                                </div>
                                <div className="flex-1">
                                    <h4 className="font-black text-slate-800 text-sm">Resultados disponibles</h4>
                                    <p className="text-xs text-slate-500 mt-1">Análisis de sangre completado</p>
                                    <p className="text-[10px] text-slate-400 mt-1 font-bold uppercase"><i className="far fa-clock mr-1"></i>Hace 2 horas</p>
                                </div>
                            </div>
                            <div className="flex items-start gap-4 pb-4 border-b border-slate-100">
                                <div className="w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center text-blue-600 flex-shrink-0">
                                    <i className="fas fa-calendar"></i>
                                </div>
                                <div className="flex-1">
                                    <h4 className="font-black text-slate-800 text-sm">Cita confirmada</h4>
                                    <p className="text-xs text-slate-500 mt-1">Dr. Silva - Medicina General</p>
                                    <p className="text-[10px] text-slate-400 mt-1 font-bold uppercase"><i className="far fa-clock mr-1"></i>Hace 1 día</p>
                                </div>
                            </div>
                            <div className="flex items-start gap-4">
                                <div className="w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center text-amber-600 flex-shrink-0">
                                    <i className="fas fa-pills"></i>
                                </div>
                                <div className="flex-1">
                                    <h4 className="font-black text-slate-800 text-sm">Recordatorio</h4>
                                    <p className="text-xs text-slate-500 mt-1">Tomar medicación de 8:00 PM</p>
                                    <p className="text-[10px] text-slate-400 mt-1 font-bold uppercase"><i className="far fa-clock mr-1"></i>Hace 3 días</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                {/* Acceso rápido a servicios */}
                <div className="bg-gradient-to-r from-slate-50 to-blue-50 rounded-[2.5rem] p-8 border-2 border-slate-100">
                    <h3 className="text-2xl font-black text-slate-800 mb-6">Servicios Rápidos</h3>
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                        {[
                            { icon: 'fa-hospital', label: 'Centros Médicos', color: 'blue' },
                            { icon: 'fa-file-medical-alt', label: 'Historia Clínica', color: 'indigo' },
                            { icon: 'fa-prescription-bottle', label: 'Medicamentos', color: 'green' },
                            { icon: 'fa-ambulance', label: 'Emergencias', color: 'red' }
                        ].map((service, i) => (
                            <div key={i} className="bg-white p-6 rounded-2xl text-center hover:shadow-xl transition-all cursor-pointer group border-2 border-transparent hover:border-blue-200">
                                <div className={`w-16 h-16 mx-auto bg-${service.color}-100 rounded-2xl flex items-center justify-center text-${service.color}-600 text-2xl mb-3 group-hover:scale-110 transition`}>
                                    <i className={`fas ${service.icon}`}></i>
                                </div>
                                <p className="text-sm font-black text-slate-800">{service.label}</p>
                            </div>
                        ))}
                    </div>
                </div>
            </div>
        );

        // Datos específicos para cada usuario
        const userData = {
            'juan.perez@uis.edu.co': {
                nombre: 'Juan',
                apellido: 'Pérez',
                notificaciones: [
                    { id: 1, tipo: 'Cita', titulo: 'Próxima cita programada', mensaje: 'Tu cita con el Dr. Silva es mañana a las 10:00 AM', tiempo: 'Hace 2 horas', leido: false, icon: 'fa-calendar-check', color: 'blue' },
                    { id: 2, tipo: 'Resultado', titulo: 'Resultados disponibles', mensaje: 'Tus análisis de sangre están listos para revisar', tiempo: 'Hace 5 horas', leido: false, icon: 'fa-file-medical', color: 'green' },
                    { id: 3, tipo: 'Recordatorio', titulo: 'Toma de medicamento', mensaje: 'Recuerda tomar tu medicación de las 8:00 PM', tiempo: 'Hace 1 día', leido: false, icon: 'fa-pills', color: 'amber' },
                ],
                citas: '02',
                resultados: '05',
                mensaje: 'Tu historial médico está al día. Revisa tus notificaciones para ver los resultados.'
            },
            'maria.garcia@uis.edu.co': {
                nombre: 'María',
                apellido: 'García',
                notificaciones: [
                    { id: 1, tipo: 'Urgente', titulo: 'Recordatorio importante', mensaje: 'No olvides tu cita de control cardiovascular el viernes', tiempo: 'Hace 1 hora', leido: false, icon: 'fa-heartbeat', color: 'red' },
                    { id: 2, tipo: 'Resultado', titulo: 'Electrocardiograma disponible', mensaje: 'Los resultados de tu electrocardiograma ya están listos', tiempo: 'Hace 3 horas', leido: false, icon: 'fa-file-medical', color: 'green' },
                    { id: 3, tipo: 'Cita', titulo: 'Confirmación recibida', mensaje: 'Tu cita con la Dra. García fue confirmada para el 20 de febrero', tiempo: 'Hace 2 días', leido: true, icon: 'fa-check-circle', color: 'blue' },
                    { id: 4, tipo: 'Recordatorio', titulo: 'Dieta saludable', mensaje: 'Continúa con tu plan nutricional bajo en sodio', tiempo: 'Hace 3 días', leido: true, icon: 'fa-apple-alt', color: 'green' },
                    { id: 5, tipo: 'Sistema', titulo: 'Actualización de app', mensaje: 'Nueva versión disponible con mejoras de seguridad', tiempo: 'Hace 4 días', leido: true, icon: 'fa-mobile-alt', color: 'indigo' },
                ],
                citas: '04',
                resultados: '08',
                mensaje: 'Tienes una cita importante próximamente. Por favor revisa tus resultados de cardiología.'
            },
            'carlos.rodriguez@uis.edu.co': {
                nombre: 'Carlos',
                apellido: 'Rodríguez',
                notificaciones: [
                    { id: 1, tipo: 'Resultado', titulo: 'Radiografía disponible', mensaje: 'Los resultados de tu radiografía de tórax están listos', tiempo: 'Hace 30 minutos', leido: false, icon: 'fa-x-ray', color: 'blue' },
                    { id: 2, tipo: 'Cita', titulo: 'Nueva cita agendada', mensaje: 'Cita con el Dr. Torres confirmada para el 18 de febrero a las 3:00 PM', tiempo: 'Hace 4 horas', leido: false, icon: 'fa-calendar-plus', color: 'blue' },
                    { id: 3, tipo: 'Recordatorio', titulo: 'Vacunación pendiente', mensaje: 'Recuerda aplicar tu refuerzo de vacuna antigripal', tiempo: 'Hace 6 horas', leido: false, icon: 'fa-syringe', color: 'amber' },
                    { id: 4, tipo: 'Sistema', titulo: 'Encuesta de satisfacción', mensaje: 'Ayúdanos a mejorar completando nuestra encuesta', tiempo: 'Hace 1 día', leido: false, icon: 'fa-clipboard-list', color: 'indigo' },
                    { id: 5, tipo: 'Resultado', titulo: 'Análisis completo', mensaje: 'Resultados de química sanguínea disponibles', tiempo: 'Hace 2 días', leido: true, icon: 'fa-vial', color: 'green' },
                    { id: 6, tipo: 'Cita', titulo: 'Recordatorio de cita', mensaje: 'Tu cita odontológica es en 3 días', tiempo: 'Hace 3 días', leido: true, icon: 'fa-tooth', color: 'blue' },
                ],
                citas: '06',
                resultados: '12',
                mensaje: 'Tienes varios resultados nuevos disponibles. Agenda tu cita de seguimiento pronto.'
            },
            // Perfil predeterminado para nuevos usuarios
            'default': {
                nombre: 'Usuario',
                apellido: 'Nuevo',
                notificaciones: [
                    { id: 1, tipo: 'Bienvenida', titulo: '¡Bienvenido a Salud UIS App!', mensaje: 'Tu cuenta ha sido creada exitosamente. Completa tu perfil médico para una mejor experiencia.', tiempo: 'Ahora', leido: false, icon: 'fa-heart', color: 'blue' },
                    { id: 2, tipo: 'Recordatorio', titulo: 'Completa tu perfil', mensaje: 'Añade tu información médica y de contacto de emergencia', tiempo: 'Hace 1 minuto', leido: false, icon: 'fa-user-edit', color: 'indigo' },
                    { id: 3, tipo: 'Sistema', titulo: 'Explora la aplicación', mensaje: 'Conoce nuestros centros médicos y agenda tu primera cita', tiempo: 'Hace 2 minutos', leido: false, icon: 'fa-compass', color: 'green' },
                    { id: 4, tipo: 'Información', titulo: 'Horarios de atención', mensaje: 'Nuestros centros están disponibles de lunes a sábado de 8:00 AM a 8:00 PM', tiempo: 'Hace 5 minutos', leido: true, icon: 'fa-clock', color: 'amber' },
                ],
                citas: '00',
                resultados: '00',
                mensaje: '¡Bienvenido a Salud UIS App! Comienza agendando tu primera cita médica.'
            }
        };

        const App = () => {
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [showRegister, setShowRegister] = useState(false);
            const [currentUser, setCurrentUser] = useState(null);
            const [page, setPage] = useState('home');
            const [notificationCount, setNotificationCount] = useState(3);
            const [userNotifications, setUserNotifications] = useState([]);

            // Inicializar usuarios predefinidos al cargar la app
            useEffect(() => {
                const initUsers = async () => {
                    try {
                        await dbManager.init();
                        await dbManager.initializeDefaultUsers();
                        console.log('Usuarios predefinidos inicializados');
                    } catch (error) {
                        console.error('Error al inicializar usuarios:', error);
                    }
                };
                initUsers();
            }, []);
            
            const handleLogin = (user) => {
                setCurrentUser(user);
                // Si el usuario existe en userData, usar sus datos, sino usar el perfil predeterminado
                const userProfile = userData[user.email] || userData['default'];
                setUserNotifications(userProfile.notificaciones);
                setNotificationCount(userProfile.notificaciones.filter(n => !n.leido).length);
                setIsLoggedIn(true);
                setShowRegister(false);
            };

            const handleLogout = () => {
                setIsLoggedIn(false);
                setCurrentUser(null);
                setUserNotifications([]);
                setPage('home');
            };

            const handleMarkAsRead = () => {
                const updatedNotifications = userNotifications.map(n => ({ ...n, leido: true }));
                setUserNotifications(updatedNotifications);
                setNotificationCount(0);
                alert('Todas las notificaciones han sido marcadas como leídas');
            };

            // Obtener datos del usuario actual
            const getUserStats = () => {
                if (!currentUser) return { citas: '00', resultados: '00', mensaje: '', notificaciones: [] };
                // Si el usuario existe en userData, usar sus datos, sino usar el perfil predeterminado
                return userData[currentUser.email] || userData['default'];
            };

            const userStats = getUserStats();

            if (!isLoggedIn) {
                if (showRegister) {
                    return <RegisterScreen onBackToLogin={() => setShowRegister(false)} onRegisterSuccess={() => setShowRegister(false)} />;
                }
                return <LoginScreen onLogin={handleLogin} onShowRegister={() => setShowRegister(true)} />;
            }

            return (
                <div className="min-h-screen flex flex-col">
                    <Navbar 
                        setPage={setPage} 
                        page={page} 
                        onLogout={handleLogout} 
                        notificationCount={notificationCount} 
                        userName={currentUser?.nombre || 'Usuario'}
                    />
                    <main className="flex-1">
                        {page === 'home' && <Dashboard userName={currentUser?.nombre || 'Usuario'} userEmail={currentUser?.email} userStats={userStats} />}
                        {page === 'centros' && <Centros />}
                        {page === 'reservar' && <Reservar />}
                        {page === 'notificaciones' && <Notificaciones onMarkAsRead={handleMarkAsRead} notificaciones={userNotifications} />}
                    </main>
                    <footer className="py-8 bg-slate-50 border-t border-slate-100">
                        <div className="max-w-7xl mx-auto px-8">
                            <div className="flex flex-col md:flex-row items-center justify-between gap-4">
                                <div className="flex items-center gap-3">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/c/c3/Logotipo_UIS.png" alt="UIS Logo" className="h-8 opacity-60" />
                                    <div className="border-l-2 border-slate-200 pl-3">
                                        <p className="text-slate-800 text-sm font-black">Salud UIS App</p>
                                        <p className="text-slate-400 text-[9px] font-bold uppercase tracking-wider">Universidad Industrial de Santander</p>
                                    </div>
                                </div>
                                <p className="text-[10px] text-slate-400 font-black uppercase tracking-[0.3em]">&copy; 2026 Todos los derechos reservados</p>
                            </div>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>